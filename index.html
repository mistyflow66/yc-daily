<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dashboard.exe</title>
    <link rel="icon" type="image/webp" href="icon.webp">
    <link rel="apple-touch-icon" href="icon.webp">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@500;700&display=swap');
        :root {
            --bg: #0E0B14; --surface: #181225;
            --primary: #7B3DFF; --secondary: #FF6A3D;
            --accent-yellow: #FFC247; --accent-green: #2BCB7D;
            --accent-pink: #E5A3C7; --accent-blue: #3D57FF;
            --text: #F3F0FF; --text-muted: #B8AFCF;
        }
        body { 
            background-color: var(--bg); 
            color: var(--text); 
            font-family: sans-serif;
            position: relative;
            overflow-x: hidden;
        }

        .font-serif-tc { font-family: 'Noto Serif TC', serif; }
        .surface { background-color: var(--surface); border: 1px solid rgba(255,255,255,0.05); }
        .done-text { text-decoration: line-through; color: var(--text-muted); opacity: 0.5; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 10px; }

        /* --- Ë≤ìÂí™Ê®£Âºè --- */
        /* --- ‰øÆÊ≠£ÂæåÁöÑË≤ìÂí™ËàáÂ∞çË©±Ê°ÜÊ®£Âºè --- */
        #pixel-cat {
            position: absolute;
            bottom: -20px; /* Â∑≤Áßª‰∏ä‰æÜÔºåÊõ¥Èù†Ëøë Shopping ÂàóË°® */
            left: 50px;
            width: 30px;
            height: 20px;
            background: #FFFFFF;
            border-radius: 10px 10px 5px 5px;
            cursor: pointer;
            z-index: 100;
            transition: transform 0.2s linear;
            animation: catBounce 0.6s infinite alternate;
            user-select: none;
            -webkit-user-drag: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        #pixel-cat::before, #pixel-cat::after {
            content: "";
            position: absolute;
            top: -8px;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 10px solid #FFFFFF;
        }
        #pixel-cat::before { left: 2px; transform: rotate(-10deg); }
        #pixel-cat::after { right: 2px; transform: rotate(10deg); }

        #cat-eyes {
            position: absolute;
            top: 6px; left: 5px; width: 20px;
            display: flex; justify-content: space-around;
            pointer-events: none;
            transition: transform 0.1s;
        }
        .eye { width: 4px; height: 4px; background: #181225; border-radius: 50%; }

        #cat-tail {
            position: absolute;
            right: -8px; bottom: 5px;
            width: 12px; height: 6px;
            background: #FFFFFF;
            border-radius: 0 5px 5px 0;
            transform-origin: left;
            animation: tailWag 0.4s infinite alternate;
        }

        @keyframes catBounce { from { transform: translateY(0); } to { transform: translateY(-3px); } }
        @keyframes tailWag { from { transform: rotate(0deg); } to { transform: rotate(30deg); } }

        /* --- ‰øÆÊ≠£ÂæåÁöÑÂ∞çË©±Ê°ÜÊ®£ÂºèÔºåÁßªÈô§Á¥∞ÈªëÁ∑ö --- */
        #cat-bubble {
            position: absolute;
            bottom: 35px; 
            left: 50%;
            transform: translateX(-20%);
            background: white;
            color: black;
            padding: 5px 12px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: bold;
            display: none;
            z-index: 110;
            pointer-events: none;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            border: none;
        }

        #cat-bubble::after {
            content: "";
            position: absolute;
            bottom: -5px; /* Ëàá‰∏ªÈ´îÈáçÁñä 1px Ê∂àÈô§Á¥∞Á∑öÁ∏´Èöô */
            left: 15px;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 6px 6px 0 0;
            border-color: white transparent transparent transparent;
            display: block;
        }


        main { position: relative; padding-bottom: 100px; }
    </style>
</head>
<body class="p-4 pb-10">

    <div class="max-w-md mx-auto space-y-6">
        <header class="flex justify-between items-center py-2">
            <h1 class="text-2xl font-black tracking-tighter" style="color: var(--primary)">DASHBOARD.exe</h1>
            <div class="flex gap-2">
                <button onclick="resetToken()" class="text-[9px] opacity-30 hover:opacity-100 border border-white/20 px-2 py-0.5 rounded">RESET KEY</button>
                <div id="status" class="text-[10px] uppercase tracking-widest px-2 py-1 rounded bg-white/5 text-muted">Initializing...</div>
            </div>
        </header>

        <section class="surface rounded-3xl p-6 shadow-2xl relative overflow-hidden min-h-[140px] flex flex-col justify-center">
            <div id="lyric-content" class="relative z-10"></div>
            <div id="video-container" class="hidden mt-4 overflow-hidden rounded-xl bg-black aspect-video relative z-10"></div>
            <div class="absolute -top-10 -right-10 w-32 h-32 blur-[80px]" style="background: var(--primary); opacity: 0.2;"></div>
        </section>

        <div class="surface p-5 rounded-3xl shadow-xl">
            <input id="mainInput" type="text" placeholder="Input command..." 
                class="w-full bg-black/40 text-white placeholder-slate-600 p-4 rounded-2xl outline-none focus:ring-1 focus:ring-purple-500 mb-4">
            <div class="grid grid-cols-3 gap-2">
                <button onclick="togglePriority()" class="py-3 rounded-xl text-xs font-bold transition-all active:scale-95" style="background: var(--primary)">Ôºã TASK</button>
                <button onclick="addItem('idea')" class="py-3 rounded-xl text-xs font-bold opacity-80" style="background: var(--surface); border: 1px solid var(--primary)">IDEA</button>
                <button onclick="addItem('buy')" class="py-3 rounded-xl text-xs font-bold opacity-80" style="background: var(--surface); border: 1px solid var(--primary)">BUY</button>
            </div>
            <div id="priorityGroup" class="hidden grid grid-cols-3 gap-2 mt-4 pt-4 border-t border-white/5">
                <button onclick="addTodo(1)" class="py-2 rounded-lg text-[10px] font-bold border border-red-500/50 text-red-400">CRITICAL</button>
                <button onclick="addTodo(2)" class="py-2 rounded-lg text-[10px] font-bold border border-yellow-500/50 text-yellow-400">NORMAL</button>
                <button onclick="addTodo(3)" class="py-2 rounded-lg text-[10px] font-bold border border-green-500/50 text-green-400">LOW</button>
            </div>
        </div>

        <main class="space-y-8">
            <section>
                <div class="flex justify-between items-center mb-3 px-2">
                    <h2 class="text-[10px] font-bold tracking-widest uppercase" style="color: var(--accent-blue)">üìù To-Do / Priority</h2>
                    <button onclick="clearCompleted('todo')" class="text-[10px] opacity-50 hover:opacity-100">CLEAN DONE</button>
                </div>
                <ul id="todoList" class="space-y-2"></ul>
            </section>
            <section>
                <h2 class="text-[10px] font-bold tracking-widest uppercase mb-3 px-2" style="color: var(--accent-pink)">üí° Brainstorm</h2>
                <ul id="ideaList" class="space-y-2"></ul>
            </section>
            <section>
                <h2 class="text-[10px] font-bold tracking-widest uppercase mb-3 px-2" style="color: var(--accent-yellow)">üõí Shopping</h2>
                <ul id="buyList" class="space-y-2"></ul>
            </section>

            <div id="pixel-cat" onclick="meow()">
                <div id="cat-eyes">
                    <div class="eye"></div>
                    <div class="eye"></div>
                </div>
                <div id="cat-tail"></div>
                <div id="cat-bubble">MEOW!</div>
            </div>
        </main>
    </div>

    <script>
        const CONFIG = { LYRICS_URL: 'https://raw.githubusercontent.com/mistyflow66/yc-daily/refs/heads/main/lyrics.json' };
        let db = { todo: [], idea: [], buy: [] };
        let lyricsDB = [];
        let currentLyric = null;
        let catX = 50, catTargetX = 50, isWalking = true, meowTimer = null;

        function getToken() {
            let t = localStorage.getItem('GIST_TOKEN');
            if (!t) { t = prompt("Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑ GitHub Token:"); if (t) localStorage.setItem('GIST_TOKEN', t); }
            return t;
        }
        function getGistId() {
            let i = localStorage.getItem('GIST_ID_KEY');
            if (!i) { i = prompt("Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑ Gist ID:"); if (i) localStorage.setItem('GIST_ID_KEY', i); }
            return i;
        }
        function resetToken() { localStorage.clear(); location.reload(); }

        async function init() {
            updateStatus('Initializing...');
            const token = getToken(); const gistId = getGistId();
            if (!token || !gistId) { updateStatus('Setup Required'); setTimeout(startCatAnimation, 500); return; }

            try {
                const lRes = await fetch(CONFIG.LYRICS_URL); lyricsDB = await lRes.json();
                const gRes = await fetch(`https://api.github.com/gists/${gistId}`, { headers: { Authorization: `token ${token}` } });
                const gData = await gRes.json(); db = JSON.parse(gData.files['dashboard.json'].content);
                renderAll(); refreshLyric(); updateStatus('System Online');
            } catch (e) { updateStatus('Sync Error'); }
            setTimeout(startCatAnimation, 500);
        }

        function startCatAnimation() {
            const main = document.querySelector('main');
            if (!main || main.offsetWidth === 0) { setTimeout(startCatAnimation, 100); return; }
            catTargetX = (main.offsetWidth - 40) * Math.random();
            moveCat();
        }

        function moveCat() {
            const cat = document.getElementById('pixel-cat');
            const main = document.querySelector('main');
            if(!cat || !main) return;
            const mainWidth = main.offsetWidth - 40;

            if (isWalking) {
                if (Math.abs(catX - catTargetX) < 2) {
                    isWalking = false;
                    setTimeout(() => {
                        catTargetX = Math.random() * mainWidth;
                        isWalking = true;
                        cat.style.transform = catTargetX > catX ? 'scaleX(-1)' : 'scaleX(1)';
                    }, Math.random() * 4000 + 2000);
                } else {
                    catX += (catTargetX > catX ? 0.7 : -0.7);
                    catX = Math.max(0, Math.min(mainWidth, catX));
                    cat.style.left = catX + 'px';
                }
            }
            requestAnimationFrame(moveCat);
        }

        function meow() {
            const bubble = document.getElementById('cat-bubble');
            const msgs = ["MEOW!", "ÂñµÁöÑÂíßÔΩû", "ÊÉ≥Ë¶ÅÁΩêÁΩê...", "ÊàëÂ∑°ÈÇè‰∏≠", "Â∑•‰ΩúÂä†Ê≤πÔºÅ", "‰∏çË¶ÅÊë∏ÊàëÔΩû"];
            bubble.innerText = msgs[Math.floor(Math.random() * msgs.length)];
            bubble.style.display = 'block';
            if(meowTimer) clearTimeout(meowTimer);
            meowTimer = setTimeout(() => bubble.style.display = 'none', 4000);
            
            const eyes = document.getElementById('cat-eyes');
            eyes.style.transform = 'scaleY(0.1)';
            setTimeout(() => eyes.style.transform = 'scaleY(1)', 150);
        }

        async function syncCloud() {
            const t = getToken(); const i = getGistId(); if (!t || !i) return;
            try { await fetch(`https://api.github.com/gists/${i}`, {
                method: 'PATCH', headers: { Authorization: `token ${t}` },
                body: JSON.stringify({ files: { 'dashboard.json': { content: JSON.stringify(db) } } })
            }); } catch (e) {}
        }

        function renderList(type) {
            const list = document.getElementById(type + 'List'); if (!list) return;
            const colors = { 1: 'var(--secondary)', 2: 'var(--accent-yellow)', 3: 'var(--accent-green)' };
            list.innerHTML = (db[type] || []).map(item => `
                <li class="surface p-4 rounded-2xl flex justify-between items-center group">
                    <div class="flex items-center gap-3 flex-1 cursor-pointer" onclick="toggleDone('${type}', ${item.id})">
                        <div class="w-2 h-2 rounded-full" style="background: ${type==='todo' ? colors[item.level] : 'var(--primary)'}"></div>
                        <span class="text-sm ${item.done ? 'done-text' : ''}">${item.text}</span>
                    </div>
                    <button onclick="deleteItem('${type}', ${item.id})" class="opacity-0 group-hover:opacity-100 text-xs text-slate-500">‚úï</button>
                </li>
            `).join('');
        }

        function refreshLyric() {
            if (!lyricsDB.length) return;
            currentLyric = lyricsDB[Math.floor(Math.random() * lyricsDB.length)];
            const isEn = !/[‰∏Ä-Èæ•]/.test(currentLyric.quote);
            document.getElementById('lyric-content').innerHTML = `<div class="font-serif-tc text-lg mb-3 italic">${isEn ? '‚Äú' : '„Äå'}${currentLyric.quote}${isEn ? '‚Äù' : '„Äç'}</div><div class="flex justify-between items-center"><span class="text-[10px] uppercase tracking-widest text-muted">// ${currentLyric.title}</span><button onclick="toggleVideo()" class="text-[10px] font-bold text-accent-green">DISPLAY_FULL</button></div>`;
        }

        function toggleVideo() {
            const v = document.getElementById('video-container');
            if (v.classList.contains('hidden')) {
                v.innerHTML = `<iframe width="100%" height="100%" src="https://www.youtube.com/embed/${currentLyric.ytId}?autoplay=1" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
                v.classList.remove('hidden');
            } else { v.classList.add('hidden'); v.innerHTML = ''; }
        }

        function togglePriority() { document.getElementById('priorityGroup').classList.toggle('hidden'); }
        async function addTodo(l) { const t = document.getElementById('mainInput').value; if(!t) return; db.todo.push({ id: Date.now(), text: t, level: l, done: false }); db.todo.sort((a,b) => a.level - b.level); await finalizeAction(); }
        async function addItem(type) { const t = document.getElementById('mainInput').value; if(!t) return; db[type].push({ id: Date.now(), text: t, done: false }); await finalizeAction(); }
        async function toggleDone(t, id) { db[t] = db[t].map(i => i.id === id ? {...i, done: !i.done} : i); renderList(t); await syncCloud(); }
        async function deleteItem(t, id) { db[t] = db[t].filter(i => i.id !== id); renderAll(); await syncCloud(); }
        async function clearCompleted() { ['todo', 'idea', 'buy'].forEach(t => { if (db[t]) db[t] = db[t].filter(i => !i.done); }); renderAll(); await syncCloud(); }
        async function finalizeAction() { document.getElementById('mainInput').value = ''; document.getElementById('priorityGroup').classList.add('hidden'); renderAll(); refreshLyric(); await syncCloud(); }
        function renderAll() { ['todo', 'idea', 'buy'].forEach(renderList); }
        function updateStatus(txt) { document.getElementById('status').innerText = txt; }

        init();
    </script>
</body>
</html>

